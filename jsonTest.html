<html>
<head>
<style type="text/css">
  #container {
    max-width: 800px;
    height: 800px;
    margin: auto;
   
  }
   
#jsontext {
   position: absolute;
   left: 10%;
   top: 10%;
   width: 400px;
   height: 150px;
}
   
#submit {
   position: absolute;
   left: 11%;
   top: 35%;
}
</style>
   <script src="build/sigma.min.js"></script>
<script src="build/plugins/sigma.parsers.json.min.js"></script>
   <script src="build/plugins/sigma.renderers.parallelEdges.min.js"></script>
   <script type="text/javascript" src="heap.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
   <script>
      
     var yourJSONObject = {
  "gateways": [
    {
      id: "child1",
      type: "main",
      nodes: ["child2", "gateway"]
    },
     {id: "gateway",
      type: "activemq",
      nodes: ["child1", "child2"]
    },
     {
        id: "child3",
        type:"service",
        nodes:[]
     },
    
    {
      id: "child2",
      type: "html",
      nodes: ["gateway"]
    }
     
     ]
}     
   
// var yourJSONObject = $('#jsontext').val();
//  
   </script>
</head>
<body>
    <input id="jsontext" type="text">
    <div id="container"></div> 
   
<!--   <input type="button" onclick="do()">-->

<script>
   
//   function blahblah() {
// 
   var weights = {activemq: 1, main:2, html:3, postmsg:4, service:5};

   
      var heap = new Heap(function cmp(a, b) {
        if (a.weight < b.weight) {
          return -1;
        } 
        if (a.weight > b.weight) {
          return 1;
        }
        return 0;
      });

   var s = new sigma('container');
 
   var main = new RegExp('/main+/');

   
   var x = 0;
   var y = 0;
   var edge = 0;
   for (i = 0; i < yourJSONObject.gateways.length; i++) {
      var tempNode = yourJSONObject.gateways[i];
      tempNode.label = tempNode.id;
      tempNode.size = 3;
      tempNode.weight = weights[String(tempNode.type)];
     
       heap.push(tempNode);
     
      }
   
    for (i = 0; i < yourJSONObject.gateways.length; i++) {
      var tempNode = heap.pop();
      tempNode.x = Math.random(0, 0.5);
      tempNode.y = y + 0.2;
      x = x+0.2;
      y = y+0.2;
      s.graph.addNode(tempNode);

   }
   
   
   //alert(JSON.stringify(heap.pop(tempNode));
   //adding edges
   for (i = 0; i < yourJSONObject.gateways.length; i++) {
      var tempNode = yourJSONObject.gateways[i];
      if (tempNode.nodes != {}) {
         for (j = 0; j < tempNode.nodes.length; j++) {
         s.graph.addEdge({id:edge.toString(), target: tempNode.nodes[j], source: tempNode.id});
         edge++;
          }
      }
         
   }
 
         
</script>
  <input type="button" value="hi" id='submit' onclick="s.graph.clear()">SubmitJSON</input>
  
</body>
</html>